# /test-ai

AI í”„ë¡¬í”„íŠ¸ì™€ í˜ì´ë¡œë“œë¥¼ í…ŒìŠ¤íŠ¸í•©ë‹ˆë‹¤. Dry-run ëª¨ë“œë¡œ ì‹¤ì œ API í˜¸ì¶œ ì—†ì´ ê²€ì¦í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## Usage

```
/test-ai                    # í˜„ì¬ ì„¤ì •ìœ¼ë¡œ í˜ì´ë¡œë“œ ë¯¸ë¦¬ë³´ê¸°
/test-ai --mode translate   # ë²ˆì—­ ëª¨ë“œ í˜ì´ë¡œë“œ í…ŒìŠ¤íŠ¸
/test-ai --mode chat        # ì±„íŒ… ëª¨ë“œ í˜ì´ë¡œë“œ í…ŒìŠ¤íŠ¸
/test-ai --tokens           # í† í° ì‚¬ìš©ëŸ‰ ì¶”ì •
/test-ai --live             # ì‹¤ì œ API í˜¸ì¶œ (ì£¼ì˜!)
```

## Test Scenarios

### 1. Translation Mode Test

```
/test-ai --mode translate
```

**ê²€ì¦ í•­ëª©**:
- System prompt êµ¬ì„±
- Source document JSON ìœ íš¨ì„±
- Translation rules í¬í•¨ ì—¬ë¶€
- Project context í¬í•¨ ì—¬ë¶€
- Glossary ë§¤ì¹­ í•­ëª©

**ì¶œë ¥ ì˜ˆì‹œ**:
```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
              TRANSLATION MODE - DRY RUN
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“‹ PAYLOAD STRUCTURE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Messages: 2 (SystemMessage + HumanMessage)

[SystemMessage] (2,450 tokens est.)
â”œâ”€ Role definition: âœ…
â”œâ”€ Translation rules: âœ… (1,200 chars)
â”œâ”€ Project context: âœ… (800 chars)
â”œâ”€ Glossary terms: 12 matched
â””â”€ Output format: TipTap JSON enforced

[HumanMessage] (3,200 tokens est.)
â””â”€ Source document: 15 nodes, 2,800 chars

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸ“Š TOKEN ESTIMATION
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Input tokens:   ~5,650
Output tokens:  ~3,500 (estimated)
Total:          ~9,150
Cost (GPT-4o):  ~$0.027

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

âš ï¸  WARNINGS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â€¢ Glossaryì— 12ê°œ ìš©ì–´ ë§¤ì¹­ë¨ - ì»¨í…ìŠ¤íŠ¸ ì¦ê°€
â€¢ Source ë¬¸ì„œì— code block í¬í•¨ - ë²ˆì—­ ì œì™¸ ê¶Œì¥

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

âœ… VALIDATION PASSED
Ready for translation. Use --live to execute.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### 2. Chat Mode Test

```
/test-ai --mode chat
```

**ê²€ì¦ í•­ëª©**:
- Chat history ê¸¸ì´ (max 10)
- Tool definitions
- Document ë¯¸í¬í•¨ í™•ì¸ (on-demand fetch)
- System prompt êµ¬ì„±

**ì¶œë ¥ ì˜ˆì‹œ**:
```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                CHAT MODE - DRY RUN
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“‹ PAYLOAD STRUCTURE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Messages: 8 (System + 7 history)

[SystemMessage] (1,800 tokens est.)
â”œâ”€ Role definition: âœ…
â”œâ”€ Translation rules: âœ…
â”œâ”€ Project context: âœ…
â””â”€ Available tools: 4

[Chat History] (2,100 tokens est.)
â”œâ”€ Messages: 7 of 10 max
â”œâ”€ User messages: 4
â”œâ”€ Assistant messages: 3
â””â”€ Tool calls in history: 1

[Tools Defined]
â”œâ”€ get_source_document
â”œâ”€ get_target_document
â”œâ”€ suggest_translation_rule
â””â”€ suggest_project_context

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸ“Š TOKEN ESTIMATION
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Input tokens:   ~3,900
Tool overhead:  ~400
Output tokens:  ~500 (estimated)
Total:          ~4,800

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

âœ… DOCUMENTS NOT INCLUDED (on-demand via tools)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Source: 2,800 chars (will fetch if tool called)
Target: 3,200 chars (will fetch if tool called)
Savings: ~1,500 tokens

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

## Token Analysis (--tokens)

```
/test-ai --tokens
```

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                  TOKEN BREAKDOWN
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“Š CURRENT CONTEXT USAGE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Component              Chars      Tokens (est.)    Limit
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Translation Rules      8,500      2,125           10,000
Project Context        12,000     3,000           30,000
Glossary              5,200      1,300           30,000
Source Document        28,000     7,000           100,000
Target Document        32,000     8,000           100,000
Attachments           0          0               50,000
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TOTAL                 85,700     21,425

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸ“ˆ USAGE BY MODE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Translation Mode:  ~12,125 tokens (rules + context + source)
Chat Mode:         ~5,125 tokens (rules + context + history)
Chat + Tools:      ~6,625 tokens (if docs fetched)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸ’¡ OPTIMIZATION SUGGESTIONS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â€¢ Project Context 85% ì‚¬ìš© ì¤‘ - ì •ë¦¬ ê¶Œì¥
â€¢ Glossaryì—ì„œ ë¯¸ì‚¬ìš© ìš©ì–´ 150ê°œ ê°ì§€
â€¢ ê¸´ ë¬¸ë‹¨ 3ê°œ ê°ì§€ - ë¶„í•  ê¶Œì¥

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

## Validation Rules

### System Prompt
- [ ] Role definition í¬í•¨
- [ ] Output format ëª…ì‹œ
- [ ] Translation rules í¬í•¨ (translate mode)
- [ ] Tool usage ì§€ì¹¨ (chat mode)

### Translation Mode
- [ ] Source document valid JSON
- [ ] Document node count < 500
- [ ] No circular references
- [ ] Glossary terms highlighted

### Chat Mode
- [ ] History â‰¤ 10 messages
- [ ] Tools properly defined
- [ ] Documents NOT in initial payload
- [ ] Request type detection working

## Live Execution (--live)

```
/test-ai --live --mode translate
```

âš ï¸ **ì£¼ì˜**: ì‹¤ì œ API í˜¸ì¶œë¡œ í† í°ì´ ì†Œë¹„ë©ë‹ˆë‹¤.

**ì‹¤í–‰ ê³¼ì •**:
1. í˜ì´ë¡œë“œ ê²€ì¦
2. ì‚¬ìš©ì í™•ì¸ í”„ë¡¬í”„íŠ¸
3. API í˜¸ì¶œ
4. ì‘ë‹µ íŒŒì‹± ê²€ì¦
5. ê²°ê³¼ í‘œì‹œ (ì ìš© ì•ˆ í•¨)

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                  LIVE TEST RESULTS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… API RESPONSE RECEIVED
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Status: 200 OK
Latency: 2,340ms
Model: gpt-4o-2024-08-06

Token Usage (Actual):
â”œâ”€ Input:  5,623
â”œâ”€ Output: 3,412
â””â”€ Total:  9,035

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸ“„ RESPONSE VALIDATION
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ… Valid JSON structure
âœ… TipTap document format
âœ… Node count: 15 (matches source)
âš ï¸  1 paragraph merged (review recommended)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Response saved to: /tmp/test-ai-response-{timestamp}.json
Use this for debugging without re-running.

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

## Integration

### With Agents
- **ai-chain**: í”„ë¡¬í”„íŠ¸ ìˆ˜ì • ì‹œ ì°¸ì¡°
- **store-sync**: í˜ì´ë¡œë“œì— í¬í•¨ëœ store ë°ì´í„° í™•ì¸

### Workflow
```
1. /test-ai --tokens          # í† í° ì‚¬ìš©ëŸ‰ í™•ì¸
2. /test-ai --mode translate  # í˜ì´ë¡œë“œ ë¯¸ë¦¬ë³´ê¸°
3. í”„ë¡¬í”„íŠ¸ ìˆ˜ì •              # í•„ìš”ì‹œ
4. /test-ai --live            # ì‹¤ì œ í…ŒìŠ¤íŠ¸
```

## Common Issues

### 1. Token Limit Exceeded
```
âŒ Estimated tokens (45,000) exceed model limit (32,000)
ğŸ’¡ Reduce: glossary (-5,000), context (-3,000), or split document
```

### 2. Invalid JSON Response
```
âŒ Response is not valid TipTap JSON
ğŸ’¡ Check system prompt output format enforcement
```

### 3. Tool Call Loop
```
âš ï¸  Tool called 3+ times in sequence
ğŸ’¡ Review tool response format - may be triggering re-calls
```
